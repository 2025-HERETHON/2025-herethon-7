{% extends "base_menu.html" %} 
{% load static %}
{% block title %}감정 통계{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/emotion_status.css' %}" />
{% endblock %} 

{% block content %}
<div class="container">
    <div class="back-header">
        <a href="{% url 'mypage' %}" class="back-arrow">
            <svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none">
                <path d="M15.909 6.95109H3.72288L9.04682 1.80561C9.4723 1.39439 9.4723 0.719571 9.04682 0.308354C8.94589 0.210607 8.826 0.133058 8.69403 0.0801464C8.56205 0.0272349 8.42057 0 8.27768 0C8.1348 0 7.99332 0.0272349 7.86134 0.0801464C7.72936 0.133058 7.60948 0.210607 7.50855 0.308354L0.319048 7.25687C0.217911 7.35442 0.137673 7.47028 0.0829265 7.59784C0.02818 7.72539 0 7.86213 0 8.00022C0 8.13832 0.02818 8.27505 0.0829265 8.40261C0.137673 8.53016 0.217911 8.64603 0.319048 8.74358L7.50855 15.6921C7.60955 15.7897 7.72946 15.8671 7.86143 15.92C7.9934 15.9728 8.13484 16 8.27768 16C8.42053 16 8.56197 15.9728 8.69394 15.92C8.82591 15.8671 8.94582 15.7897 9.04682 15.6921C9.14782 15.5945 9.22794 15.4786 9.28261 15.351C9.33727 15.2235 9.36541 15.0868 9.36541 14.9487C9.36541 14.8107 9.33727 14.674 9.28261 14.5464C9.22794 14.4189 9.14782 14.303 9.04682 14.2054L3.72288 9.0599H15.909C16.5091 9.0599 17 8.58542 17 8.0055C17 7.42557 16.5091 6.95109 15.909 6.95109Z" fill="black"/>
            </svg>
        </a>
        <h2>감정 태그 통계</h2>
    </div>
    
    <div class="top-tags-box">
        <h3> <strong>{{request.user.nickname}}님이 가장 많이 사용한 감정 Top 3</strong></h3>
    
        {% for tag in user_top_tags %}
            <div class="top-tag-item rank-{{ forloop.counter }}">
                <div class="top-tag-content">
                    {% if forloop.counter == 1 %}
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="28" viewBox="0 0 25 28" fill="none">
                            <path d="M15.2549 9.51005L10.0592 0.930005C9.72077 0.350002 9.11361 0 8.44673 0H1.88739C0.444134 0 -0.461632 1.56001 0.245064 2.82002C1.55856 5.15475 3.41241 7.13732 5.6498 8.60005C6.40626 9.19005 7.34189 9.51005 8.30738 9.51005H15.2549Z" fill="#0074BA"/>
                            <path d="M23.1082 0H16.5489C15.882 0 15.2749 0.350002 14.9364 0.930005L9.74072 9.51005H16.6982C17.6637 9.51005 18.5894 9.19005 19.3558 8.60005C21.5953 7.14004 23.4467 5.16003 24.7605 2.82002C25.4573 1.56001 24.5515 0 23.1082 0Z" fill="#00A6ED"/>
                            <path d="M12.4899 27.9998C18.0091 27.9998 22.4832 23.3928 22.4832 17.7097C22.4832 12.0267 18.0091 7.41968 12.4899 7.41968C6.97067 7.41968 2.49658 12.0267 2.49658 17.7097C2.49658 23.3928 6.97067 27.9998 12.4899 27.9998Z" fill="#FFB02E"/>
                            <path d="M10.5847 14.0415C10.5847 13.7763 10.6896 13.5219 10.8762 13.3344C11.0629 13.1469 11.3161 13.0415 11.5801 13.0415H12.4998C12.7637 13.0415 13.0169 13.1469 13.2036 13.3344C13.3902 13.5219 13.4951 13.7763 13.4951 14.0415V21.0005C13.4951 21.2658 13.3902 21.5201 13.2036 21.7077C13.0169 21.8952 12.7637 22.0006 12.4998 22.0006C12.2358 22.0006 11.9826 21.8952 11.7959 21.7077C11.6093 21.5201 11.5044 21.2658 11.5044 21.0005V15.0385C11.2543 15.0194 11.0206 14.906 10.85 14.7212C10.6795 14.5363 10.5847 14.2936 10.5847 14.0415Z" fill="#6D4534"/>
                            <path d="M12.4997 26.7606C10.1507 26.7606 7.94101 25.8206 6.28874 24.1106C4.62599 22.4003 3.69995 20.1013 3.71079 17.7105C3.71079 15.2905 4.62651 13.0205 6.28874 11.3105C7.09526 10.4731 8.06117 9.80721 9.12902 9.35244C10.1969 8.89768 11.3449 8.66333 12.5047 8.66333C13.6645 8.66333 14.8125 8.89768 15.8803 9.35244C16.9482 9.80721 17.9141 10.4731 18.7206 11.3105C22.1446 14.8405 22.1446 20.5805 18.7206 24.1106C17.0484 25.8206 14.8388 26.7606 12.4997 26.7606ZM12.4897 9.89048C10.5488 9.89048 8.59794 10.6505 7.12483 12.1805C5.69164 13.66 4.89448 15.646 4.9052 17.7105C4.9052 19.8005 5.69153 21.7605 7.12483 23.2406C7.81978 23.9652 8.65311 24.5415 9.57495 24.935C10.4968 25.3285 11.4882 25.531 12.4897 25.5306C14.5203 25.5306 16.4214 24.7206 17.8547 23.2406C20.8109 20.1905 20.8109 15.2305 17.8547 12.1805C17.1604 11.4549 16.3272 10.878 15.4052 10.4845C14.4832 10.0909 13.4915 9.88886 12.4897 9.89048Z" fill="#FCD53F"/>
                        </svg>
                    {% elif forloop.counter == 2 %}
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="28" viewBox="0 0 25 28" fill="none">
                            <path d="M15.2549 9.5097L10.0592 0.92997C9.72077 0.349989 9.11361 0 8.44673 0H1.88739C0.444134 0 -0.461632 1.55995 0.245064 2.81991C1.55856 5.15455 3.41241 7.13706 5.6498 8.59972C6.40626 9.18971 7.34189 9.5097 8.30738 9.5097H15.2549Z" fill="#0074BA"/>
                            <path d="M23.1082 0H16.5489C15.882 0 15.2749 0.349989 14.9364 0.92997L9.74072 9.5097H16.6982C17.6637 9.5097 18.5894 9.18971 19.3558 8.59972C21.5953 7.13977 23.4467 5.15983 24.7605 2.81991C25.4573 1.55995 24.5515 0 23.1082 0Z" fill="#00A6ED"/>
                            <path d="M12.4601 28C17.9793 28 22.4534 23.3931 22.4534 17.7103C22.4534 12.0275 17.9793 7.42065 12.4601 7.42065C6.94088 7.42065 2.4668 12.0275 2.4668 17.7103C2.4668 23.3931 6.94088 28 12.4601 28Z" fill="#BEBEBE"/>
                            <path d="M12.4599 26.7604C10.1109 26.7604 7.90122 25.8204 6.24894 24.1105C4.5862 22.4002 3.66015 20.1013 3.67099 17.7107C3.67099 15.2908 4.58671 13.0208 6.24894 11.3109C7.05546 10.4735 8.02137 9.80765 9.08923 9.35291C10.1571 8.89816 11.3051 8.66382 12.4649 8.66382C13.6247 8.66382 14.7727 8.89816 15.8405 9.35291C16.9084 9.80765 17.8743 10.4735 18.6808 11.3109C22.1048 14.8408 22.1048 20.5806 18.6808 24.1105C17.0086 25.8204 14.799 26.7604 12.4599 26.7604ZM12.45 9.89093C10.509 9.89093 8.55815 10.6509 7.08503 12.1809C5.65184 13.6603 4.85469 15.6463 4.86541 17.7107C4.86541 19.8006 5.65173 21.7605 7.08503 23.2405C7.77998 23.9651 8.61332 24.5414 9.53515 24.9349C10.457 25.3283 11.4484 25.5309 12.45 25.5304C14.4805 25.5304 16.3816 24.7204 17.8149 23.2405C20.7711 20.1906 20.7711 15.2308 17.8149 12.1809C17.1206 11.4553 16.2874 10.8784 15.3654 10.4849C14.4434 10.0913 13.4517 9.88931 12.45 9.89093Z" fill="#E6E6E6"/>
                            <path d="M14.3292 21.9495H10.3776C10.1873 21.95 10.0007 21.8956 9.84021 21.7928C9.67966 21.69 9.55184 21.5431 9.47188 21.3696C9.38948 21.1974 9.35787 21.0052 9.3808 20.8156C9.40373 20.6259 9.48024 20.4469 9.60127 20.2996L12.8859 16.2497C13.1447 15.9297 13.0253 15.5897 12.9855 15.4897C12.9387 15.3736 12.8591 15.2739 12.7565 15.2028C12.6539 15.1317 12.5328 15.0924 12.4082 15.0898H12.3584C12.0399 15.0898 11.7512 15.2398 11.5621 15.4997C11.2436 15.9497 10.6165 16.0597 10.1587 15.7397C10.0507 15.663 9.95883 15.5657 9.88836 15.4533C9.81789 15.3408 9.7702 15.2155 9.74801 15.0846C9.72582 14.9536 9.72957 14.8195 9.75904 14.69C9.78852 14.5605 9.84314 14.4381 9.91978 14.3298C10.4772 13.5398 11.3829 13.0698 12.3484 13.0698H12.4778C13.4931 13.1198 14.3789 13.7298 14.797 14.6598C15.225 15.6197 15.0856 16.7097 14.4287 17.5197L12.4878 19.9196H14.3192C14.8766 19.9196 15.3245 20.3696 15.3245 20.9296C15.3245 21.4896 14.8866 21.9495 14.3292 21.9495Z" fill="#636363"/>
                        </svg>
                    {% elif forloop.counter == 3 %}
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="28" viewBox="0 0 25 28" fill="none">
                            <path d="M15.2549 9.51L10.0592 0.93C9.72077 0.35 9.11361 0 8.44673 0H1.88739C0.444134 0 -0.461632 1.56 0.245064 2.82C1.55856 5.15472 3.41241 7.13729 5.6498 8.6C6.40626 9.19 7.34189 9.51 8.30738 9.51H15.2549Z" fill="#0074BA"/>
                            <path d="M23.1082 0H16.5489C15.882 0 15.2749 0.35 14.9364 0.93L9.74072 9.51H16.6982C17.6637 9.51 18.5894 9.19 19.3558 8.6C21.5953 7.14 23.4467 5.16 24.7605 2.82C25.4573 1.56 24.5515 0 23.1082 0Z" fill="#00A6ED"/>
                            <path d="M12.4899 27.9999C18.0091 27.9999 22.4832 23.3929 22.4832 17.7099C22.4832 12.0269 18.0091 7.41992 12.4899 7.41992C6.97067 7.41992 2.49658 12.0269 2.49658 17.7099C2.49658 23.3929 6.97067 27.9999 12.4899 27.9999Z" fill="#D3883E"/>
                            <path d="M12.4997 26.7602C10.1507 26.7602 7.94101 25.8202 6.28874 24.1102C4.62599 22.3999 3.69995 20.101 3.71079 17.7102C3.71079 15.2902 4.62651 13.0202 6.28874 11.3102C7.09526 10.4728 8.06117 9.80696 9.12902 9.3522C10.1969 8.89744 11.3449 8.66309 12.5047 8.66309C13.6645 8.66309 14.8125 8.89744 15.8803 9.3522C16.9482 9.80696 17.9141 10.4728 18.7206 11.3102C22.1446 14.8402 22.1446 20.5802 18.7206 24.1102C17.0484 25.8202 14.8388 26.7602 12.4997 26.7602ZM12.4897 9.89023C10.5488 9.89023 8.59794 10.6502 7.12483 12.1802C5.69164 13.6597 4.89448 15.6458 4.9052 17.7102C4.9052 19.8002 5.69153 21.7602 7.12483 23.2402C7.81978 23.9649 8.65311 24.5412 9.57495 24.9347C10.4968 25.3281 11.4882 25.5307 12.4897 25.5302C14.5203 25.5302 16.4214 24.7202 17.8547 23.2402C20.8109 20.1902 20.8109 15.2302 17.8547 12.1802C17.1604 11.4547 16.3272 10.8778 15.4052 10.4842C14.4832 10.0907 13.4915 9.88861 12.4897 9.89023Z" fill="#F3AD61"/>
                            <path d="M13.8954 16.275L14.9385 14.465C15.0236 14.3164 15.0683 14.1479 15.0683 13.9765C15.0683 13.8051 15.0236 13.6366 14.9385 13.488C14.8538 13.3394 14.7315 13.216 14.5839 13.1303C14.4364 13.0446 14.2689 12.9996 14.0984 13H11.0208C10.7684 13.0081 10.5291 13.1146 10.3534 13.2968C10.1777 13.479 10.0795 13.7228 10.0795 13.9765C10.0795 14.2302 10.1777 14.474 10.3534 14.6562C10.5291 14.8384 10.7684 14.9449 11.0208 14.953H12.4173L11.6688 16.264C11.5319 16.4338 11.4567 16.6455 11.4558 16.864C11.4558 17.404 11.8917 17.841 12.4282 17.841C13.0354 17.841 13.5311 18.339 13.5311 18.949C13.5311 19.559 13.0354 20.058 12.4282 20.058C11.9624 20.058 11.5473 19.763 11.3951 19.325C11.3084 19.083 11.13 18.8852 10.8989 18.7747C10.6677 18.6642 10.4024 18.6499 10.1608 18.735C10.0407 18.7771 9.93012 18.8427 9.83544 18.9281C9.74076 19.0135 9.66388 19.1169 9.60925 19.2323C9.55463 19.3477 9.52335 19.4729 9.51723 19.6006C9.5111 19.7282 9.53026 19.8558 9.57357 19.976C9.78519 20.5669 10.1726 21.0781 10.6833 21.4401C11.194 21.8022 11.8032 21.9977 12.4282 22C13.2331 21.9992 14.0048 21.6776 14.574 21.1058C15.1432 20.534 15.4632 19.7587 15.464 18.95C15.4628 18.4043 15.3168 17.8688 15.0411 17.3986C14.7654 16.9284 14.3699 16.5406 13.8954 16.275Z" fill="#402A32"/>
                        </svg>
                    {% endif %}
                    <div class="text">
                        <span>[{{ tag.get_tag_type_display }}]</span>
                        <span>#{{ tag.name }}</span>
                    </div>
                </div>
                <span class="count">{{ tag.usage_count }}회</span>
            </div>
        {% endfor %}
    </div>
    

    
    <div class="table-box">
    <h3><strong>{{request.user.nickname}}님의 감정 태그 비율</strong></h3>
    <table>
        <thead>
        <tr>
            <th>감정 유형</th>
            <th>감정 태그</th>
            <th>사용 횟수</th>
            <th>비율</th>
        </tr>
        </thead>
        <tbody>
        {% for tag in user_tag_distribution %}
        <tr>
            <td>{{ tag.type }}</td>
            <td>#{{ tag.name }}</td>
            <td>{{ tag.count }}</td>
            <td>{{ tag.percentage }}%</td>
        </tr>
        {% empty %}
            <tr><td colspan="4">사용한 감정 태그가 없습니다.</td></tr>

        {% endfor %}
        </tbody>
</table>
</div>
</div>

{% endblock %}